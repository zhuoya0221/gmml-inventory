(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[355],{2890:(e,t,s)=>{"use strict";s.d(t,{N:()=>r});let r=(0,s(945).UU)("https://ydamkailcnhfmutdvmsk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkYW1rYWlsY25oZm11dGR2bXNrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4NTExMzIsImV4cCI6MjA3NDQyNzEzMn0.8oSPmI_svRRq9GdvsssciUNe0PmD_fkkyhwDG5-FGdA",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},7192:(e,t,s)=>{Promise.resolve().then(s.bind(s,7400))},7400:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var r=s(5155),o=s(2115),i=s(63),a=s(2890),n=s(2663);function l(){let e=(0,i.useRouter)(),[t,s]=(0,o.useState)([]),[l,d]=(0,o.useState)(!0),[c,m]=(0,o.useState)(null),[x,u]=(0,o.useState)(null),[g,h]=(0,o.useState)([]),[f,y]=(0,o.useState)(!1),[p,b]=(0,o.useState)({name:"",category:"",current_stock:0,min_stock:0,storage_location:"",unit:"",expire_date:""}),[j,v]=(0,o.useState)({category:"",status:"",location:""}),[N,k]=(0,o.useState)(""),[w,_]=(0,o.useState)([]),[S,L]=(0,o.useState)(!1),[C,I]=(0,o.useState)(!1),[A,E]=(0,o.useState)(null);(0,o.useEffect)(()=>{M()},[]),(0,o.useEffect)(()=>{let e=t;N&&(e=e.filter(e=>e.name.toLowerCase().includes(N.toLowerCase()))),j.category&&(e=e.filter(e=>e.category===j.category)),j.status&&(e=e.filter(e=>e.status===j.status)),j.location&&(e=e.filter(e=>e.storage_location===j.location)),_(e)},[t,j,N]);let M=async()=>{d(!0);try{let{data:{user:e}}=await a.N.auth.getUser();if(m(e),!e){u(null),s([]),_([]),d(!1);return}let{data:t,error:r}=await a.N.from("profiles").select("*").eq("id",e.id).single();if(r)throw Error("Could not fetch user profile.");u(t);let{data:o,error:i}=await a.N.from("inventory_items").select("*").order("name",{ascending:!0});if(i)throw i;s(o||[]),_(o||[]);let{data:n,error:l}=await a.N.from("activity_logs").select("*").order("timestamp",{ascending:!1}).limit(50);l||h(n||[])}catch(t){let e=t instanceof Error?t.message:"An unknown error occurred.";n.Ay.error("Error fetching data: ".concat(e)),console.error("Data fetch error:",t)}finally{d(!1)}},D=async()=>{if(!c||!c.id)return void n.Ay.error("Please login to add items");if(!p.name||!p.category||!p.storage_location)return void n.Ay.error("Please fill in all required fields");let e={name:p.name,category:p.category,current_stock:p.current_stock,min_stock:p.min_stock,storage_location:p.storage_location,unit:p.unit||null,expire_date:p.expire_date||null,status:p.current_stock>p.min_stock?"In Stock":0===p.current_stock?"Out of Stock":"Low Stock",created_by:c.email,updated_by:c.email};console.log("\uD83D\uDD0D Adding item:",e);let{data:r,error:o}=await a.N.from("inventory_items").insert([e]).select().single();if(console.log("\uD83D\uDCCA Insert result:",{data:r,error:o}),o)console.error("Insert error:",o),n.Ay.error("Error: ".concat(o.message));else{console.log("âœ… Success:",r);let o=[...t,r].sort((e,t)=>e.name.localeCompare(t.name));s(o),_(o),n.Ay.success('"'.concat(p.name,'" added!')),b({name:"",category:"",current_stock:0,min_stock:0,storage_location:"",unit:"",expire_date:""}),y(!1),await z(r.id,r.name,"created",e)}},O=async()=>{if(!A||!c||!c.id)return void n.Ay.error("Please login to update items");if(!A.name||!A.category||!A.storage_location)return void n.Ay.error("Please fill in all required fields");let e={name:A.name,category:A.category,current_stock:A.current_stock,min_stock:A.min_stock,storage_location:A.storage_location,unit:A.unit||null,expire_date:A.expire_date||null,status:A.current_stock>A.min_stock?"In Stock":0===A.current_stock?"Out of Stock":"Low Stock",updated_by:c.email,updated_at:new Date().toISOString()},{data:r,error:o}=await a.N.from("inventory_items").update(e).eq("id",A.id).select().single();if(o)n.Ay.error("Error: ".concat(o.message));else{let o=t.map(e=>e.id===A.id?r:e);s(o),_(o),n.Ay.success('"'.concat(A.name,'" updated!')),E(null),I(!1),await z(A.id,A.name,"updated",e)}},F=async(e,r)=>{if(!confirm('Are you sure you want to delete "'.concat(r,'"?')))return;if(!c||!c.id)return void n.Ay.error("Please login to delete items");let{error:o}=await a.N.from("inventory_items").delete().eq("id",e);o?n.Ay.error("Error deleting item: ".concat(o.message)):(s(t.filter(t=>t.id!==e)),n.Ay.success('"'.concat(r,'" has been deleted.')),await z(e,r,"deleted",{id:e,name:r}))},V=async()=>{let{error:e}=await a.N.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.href}});e&&n.Ay.error("Login failed: ".concat(e.message))},T=async()=>{await a.N.auth.signOut(),m(null),n.Ay.success("Logged out."),window.location.href="/"},z=async(e,t,s,r)=>{if(c&&c.id)try{let o={item_id:e,user_id:c.id,user_email:c.email,action:s,changes:r,item_name:t,timestamp:new Date().toISOString()},{error:i}=await a.N.from("activity_logs").insert([o]);if(!i){let{data:e}=await a.N.from("activity_logs").select("*").order("timestamp",{ascending:!1}).limit(50);e&&h(e)}}catch(e){console.error("Error logging activity:",e)}},U=w.length,W=w.filter(e=>"In Stock"===e.status).length,B=w.filter(e=>"Low Stock"===e.status).length,G=w.filter(e=>"Out of Stock"===e.status).length;return l?(0,r.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,r.jsx)("p",{className:"text-lg",children:"Loading Team Dashboard..."})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.Toaster,{position:"top-right"}),(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,r.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-10 h-10 bg-indigo-600 rounded-lg",children:(0,r.jsx)("span",{className:"text-white font-bold text-lg",children:"G"})}),(0,r.jsx)("div",{children:(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"GMML Inventory System"})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(null==x?void 0:x.role)==="admin"&&(0,r.jsx)("button",{onClick:()=>e.push("/admin"),className:"text-sm font-semibold text-indigo-600 hover:text-indigo-800",children:"Admin Panel"}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:(null==c?void 0:c.email)||"Team Mode"}),c&&c.id?(0,r.jsx)("button",{onClick:T,className:"text-sm font-semibold text-red-600 hover:text-red-800",children:"Logout"}):(0,r.jsx)("button",{onClick:V,className:"text-sm font-semibold text-indigo-600 hover:text-indigo-800",children:"Login with Google"})]})]})})}),(0,r.jsxs)("main",{className:"mx-auto max-w-7xl py-6 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-4 mb-8",children:[(0,r.jsx)("div",{className:"overflow-hidden rounded-lg bg-white px-6 py-5 shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-900",children:"Total Items"}),(0,r.jsx)("dd",{className:"text-2xl font-semibold text-gray-900",children:U})]})]})}),(0,r.jsx)("div",{className:"overflow-hidden rounded-lg bg-white px-6 py-5 shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-900",children:"In Stock"}),(0,r.jsx)("dd",{className:"text-2xl font-semibold text-green-600",children:W})]})]})}),(0,r.jsx)("div",{className:"overflow-hidden rounded-lg bg-white px-6 py-5 shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-900",children:"Low Stock"}),(0,r.jsx)("dd",{className:"text-2xl font-semibold text-yellow-600",children:B})]})]})}),(0,r.jsx)("div",{className:"overflow-hidden rounded-lg bg-white px-6 py-5 shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-900",children:"Out of Stock"}),(0,r.jsx)("dd",{className:"text-2xl font-semibold text-red-600",children:G})]})]})})]}),(0,r.jsxs)("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 mb-6",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-gray-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Filters & Search"})]})}),(0,r.jsx)("div",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search by name"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,r.jsx)("input",{type:"text",id:"search",value:N,onChange:e=>k(e.target.value),placeholder:"Search items...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"filter-category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,r.jsxs)("select",{id:"filter-category",value:j.category,onChange:e=>v({...j,category:e.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"All Categories"}),(0,r.jsx)("option",{value:"Studying Consumables",children:"Studying Consumables"}),(0,r.jsx)("option",{value:"Stationery",children:"Stationery"}),(0,r.jsx)("option",{value:"Others",children:"Others"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"filter-location",className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),(0,r.jsxs)("select",{id:"filter-location",value:j.location,onChange:e=>v({...j,location:e.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"All Locations"}),(0,r.jsx)("option",{value:"GTR",children:"GTR"}),(0,r.jsx)("option",{value:"MD6 LEVEL9",children:"MD6 LEVEL9"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"filter-status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,r.jsxs)("select",{id:"filter-status",value:j.status,onChange:e=>v({...j,status:e.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"All Status"}),(0,r.jsx)("option",{value:"In Stock",children:"In Stock"}),(0,r.jsx)("option",{value:"Low Stock",children:"Low Stock"}),(0,r.jsx)("option",{value:"Out of Stock",children:"Out of Stock"})]})]})]})})]}),(0,r.jsxs)("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Inventory Items"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Showing ",w.length," of ",t.length," items"]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("button",{onClick:()=>L(!0),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Activity Log"]}),(0,r.jsxs)("button",{onClick:()=>{let e=w.map(e=>({"Item Name":e.name,Category:e.category,"Current Stock":e.current_stock,"Min Stock":e.min_stock,Unit:e.unit||"","Expire Date":e.expire_date?new Date(e.expire_date).toLocaleDateString():"",Status:e.status,Location:e.storage_location,Updated:new Date(e.updated_at).toLocaleDateString()}));if(0===e.length)return void n.Ay.error("No data to export.");let t=Object.keys(e[0]),s=new Blob([[t.join(","),...e.map(e=>t.map(t=>'"'.concat(String(e[t]).replace(/"/g,'""'),'"')).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),o=URL.createObjectURL(s);r.setAttribute("href",o),r.setAttribute("download","inventory_export_".concat(new Date().toISOString().split("T")[0],".csv")),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),n.Ay.success("CSV exported successfully!")},className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export CSV"]}),(0,r.jsxs)("button",{onClick:()=>y(!f),disabled:!c||!c.id,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 ".concat(c&&c.id&&(null==x?void 0:x.role)!=="user"?"bg-indigo-600 hover:bg-indigo-700":"bg-gray-400 cursor-not-allowed"),children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),c&&c.id?"Add Item":"Login to Add Items"]})]})]})}),f&&(0,r.jsxs)("div",{className:"mt-6 bg-white shadow rounded-lg p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Item"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"item-name",className:"block text-sm font-medium text-gray-700",children:"Item Name *"}),(0,r.jsx)("input",{type:"text",id:"item-name",value:p.name,onChange:e=>b({...p,name:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",placeholder:"Enter item name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"item-category",className:"block text-sm font-medium text-gray-700",children:"Category *"}),(0,r.jsxs)("select",{id:"item-category",value:p.category,onChange:e=>b({...p,category:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"Select category"}),(0,r.jsx)("option",{value:"Studying Consumables",children:"Studying Consumables"}),(0,r.jsx)("option",{value:"Stationery",children:"Stationery"}),(0,r.jsx)("option",{value:"Others",children:"Others"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"storage-location",className:"block text-sm font-medium text-gray-700",children:"Storage Location *"}),(0,r.jsxs)("select",{id:"storage-location",value:p.storage_location,onChange:e=>b({...p,storage_location:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"Select location"}),(0,r.jsx)("option",{value:"GTR",children:"GTR"}),(0,r.jsx)("option",{value:"MD6 LEVEL9",children:"MD6 LEVEL9"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"current-stock",className:"block text-sm font-medium text-gray-700",children:"Current Stock"}),(0,r.jsx)("input",{type:"number",id:"current-stock",value:p.current_stock,onChange:e=>b({...p,current_stock:parseInt(e.target.value)||0}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",min:"0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"min-stock",className:"block text-sm font-medium text-gray-700",children:"Min Stock"}),(0,r.jsx)("input",{type:"number",id:"min-stock",value:p.min_stock,onChange:e=>b({...p,min_stock:parseInt(e.target.value)||0}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",min:"0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"item-unit",className:"block text-sm font-medium text-gray-700",children:"Unit"}),(0,r.jsx)("input",{type:"text",id:"item-unit",value:p.unit,onChange:e=>b({...p,unit:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",placeholder:"e.g., pcs, kg, L"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"item-expire-date",className:"block text-sm font-medium text-gray-700",children:"Expire Date"}),(0,r.jsx)("input",{type:"date",id:"item-expire-date",value:p.expire_date,onChange:e=>b({...p,expire_date:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900"})]})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{b({name:"",category:"",current_stock:0,min_stock:0,storage_location:"",unit:"",expire_date:""}),y(!1)},className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Cancel"}),(0,r.jsx)("button",{type:"button",onClick:D,className:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Add Item"})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:w.map(e=>(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-4 flex flex-col",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-lg font-semibold text-gray-900 truncate",title:e.name,children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-500 truncate",children:e.category})]}),(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"In Stock":return"bg-green-100 text-green-800";case"Low Stock":return"bg-yellow-100 text-yellow-800";case"Out of Stock":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.status)),children:e.status})})]}),(0,r.jsxs)("div",{className:"mt-4 space-y-2 text-sm text-gray-700 flex-grow",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Stock:"})," ",e.current_stock," / ",e.min_stock," ",e.unit||""]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Location:"})," ",e.storage_location]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-x-4",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Expire Date:"})," ",e.expire_date?new Date(e.expire_date).toLocaleDateString():"-"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Updated:"})," ",new Date(e.updated_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]})]}),(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 flex justify-end space-x-2",children:(null==x?void 0:x.role)!=="user"&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>{E(e),I(!0)},disabled:!c||!c.id,className:"inline-flex items-center p-1.5 rounded-md ".concat(c&&c.id?"text-indigo-600 hover:text-indigo-900 hover:bg-indigo-50":"text-gray-400 cursor-not-allowed"),title:"Edit",children:(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,r.jsx)("button",{onClick:()=>F(e.id,e.name),disabled:!c||!c.id,className:"inline-flex items-center p-1.5 rounded-md ".concat(c&&c.id?"text-red-600 hover:text-red-900 hover:bg-red-50":"text-gray-400 cursor-not-allowed"),title:"Delete",children:(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},e.id))})]}),C&&A&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8 w-full max-w-3xl",children:[(0,r.jsx)("h3",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Edit Item"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"edit-item-name",className:"block text-sm font-medium text-gray-700",children:"Item Name *"}),(0,r.jsx)("input",{type:"text",id:"edit-item-name",value:A.name,onChange:e=>E({...A,name:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",placeholder:"Enter item name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-item-category",className:"block text-sm font-medium text-gray-700",children:"Category *"}),(0,r.jsxs)("select",{id:"edit-item-category",value:A.category,onChange:e=>E({...A,category:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"Select category"}),(0,r.jsx)("option",{value:"Studying Consumables",children:"Studying Consumables"}),(0,r.jsx)("option",{value:"Stationery",children:"Stationery"}),(0,r.jsx)("option",{value:"Others",children:"Others"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-storage-location",className:"block text-sm font-medium text-gray-700",children:"Storage Location *"}),(0,r.jsxs)("select",{id:"edit-storage-location",value:A.storage_location,onChange:e=>E({...A,storage_location:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"Select location"}),(0,r.jsx)("option",{value:"GTR",children:"GTR"}),(0,r.jsx)("option",{value:"MD6 LEVEL9",children:"MD6 LEVEL9"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-current-stock",className:"block text-sm font-medium text-gray-700",children:"Current Stock"}),(0,r.jsx)("input",{type:"number",id:"edit-current-stock",value:A.current_stock,onChange:e=>E({...A,current_stock:parseInt(e.target.value)||0}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",min:"0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-min-stock",className:"block text-sm font-medium text-gray-700",children:"Min Stock"}),(0,r.jsx)("input",{type:"number",id:"edit-min-stock",value:A.min_stock,onChange:e=>E({...A,min_stock:parseInt(e.target.value)||0}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",min:"0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-item-unit",className:"block text-sm font-medium text-gray-700",children:"Unit"}),(0,r.jsx)("input",{type:"text",id:"edit-item-unit",value:A.unit||"",onChange:e=>E({...A,unit:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",placeholder:"e.g., pcs, kg, L"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-item-expire-date",className:"block text-sm font-medium text-gray-700",children:"Expire Date"}),(0,r.jsx)("input",{type:"date",id:"edit-item-expire-date",value:A.expire_date?A.expire_date.split("T")[0]:"",onChange:e=>E({...A,expire_date:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900"})]})]}),(0,r.jsxs)("div",{className:"mt-8 flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{E(null),I(!1)},className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Cancel"}),(0,r.jsx)("button",{type:"button",onClick:O,className:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Update Item"})]})]})}),S&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,r.jsxs)("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Activity Log"}),(0,r.jsx)("button",{onClick:()=>L(!1),className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsx)("div",{className:"max-h-96 overflow-y-auto",children:0===g.length?(0,r.jsx)("p",{className:"text-gray-900 text-center py-4",children:"No activity logs yet"}):(0,r.jsx)("div",{className:"space-y-3",children:g.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat("created"===e.action?"bg-green-100 text-green-800":"updated"===e.action?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"),children:e.action})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[e.user_email," ",e.action,' "',e.item_name,'"']}),(0,r.jsx)("p",{className:"text-xs text-gray-900",children:new Date(e.timestamp).toLocaleString()}),e.changes&&(0,r.jsx)("div",{className:"mt-1 text-xs text-gray-900",children:(0,r.jsxs)("details",{children:[(0,r.jsx)("summary",{className:"cursor-pointer hover:text-gray-800",children:"View changes"}),(0,r.jsx)("pre",{className:"mt-1 p-2 bg-white rounded border text-xs overflow-x-auto",children:JSON.stringify(e.changes,null,2)})]})})]})]},t))})}),(0,r.jsx)("div",{className:"mt-4 flex justify-end",children:(0,r.jsx)("button",{onClick:()=>L(!1),className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400",children:"Close"})})]})})]})]})]})}}},e=>{e.O(0,[663,796,441,255,358],()=>e(e.s=7192)),_N_E=e.O()}]);