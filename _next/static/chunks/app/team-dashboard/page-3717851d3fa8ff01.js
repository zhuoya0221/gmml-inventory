(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[355],{2890:(e,t,s)=>{"use strict";s.d(t,{N:()=>r});let r=(0,s(945).UU)("https://ydamkailcnhfmutdvmsk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkYW1rYWlsY25oZm11dGR2bXNrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4NTExMzIsImV4cCI6MjA3NDQyNzEzMn0.8oSPmI_svRRq9GdvsssciUNe0PmD_fkkyhwDG5-FGdA",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},7192:(e,t,s)=>{Promise.resolve().then(s.bind(s,7406))},7406:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(5155),o=s(2115),a=s(63),i=s(2890),n=s(2663),l=s(7830);function d(e){let{logs:t,userProfile:s,onClose:o,onDeleteLog:a}=e,i=async e=>{if(a&&confirm("Are you sure you want to delete this activity log entry? This action cannot be undone."))try{await a(e)}catch(e){console.error("Failed to delete log:",e)}},n=(null==s?void 0:s.role)==="admin";return(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 z-50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl",children:[(0,r.jsxs)("div",{className:"p-6 border-b flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Activity Log"}),(0,r.jsx)("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsx)("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:0===t.length?(0,r.jsx)("p",{className:"text-center text-gray-500 py-8",children:"No activity to display."}):(0,r.jsx)("ul",{className:"space-y-4",children:t.map(e=>(0,r.jsx)("li",{className:"p-4 bg-gray-50 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"created":return"bg-green-100 text-green-800";case"updated":return"bg-blue-100 text-blue-800";case"deleted":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.action)),children:e.action})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[(0,r.jsx)("span",{className:"font-bold",children:e.user_email})," ",e.action," item: ",(0,r.jsx)("span",{className:"font-semibold",children:e.item_name})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",title:new Date(e.timestamp).toLocaleString(),children:(0,l.m)(new Date(e.timestamp),{addSuffix:!0})}),e.changes&&(0,r.jsxs)("p",{className:"mt-1 text-xs text-gray-600 bg-white p-2 rounded border",children:["Changes: ",Object.entries(e.changes).map(e=>{let[t,s]=e;return"".concat(t,": ").concat(JSON.stringify(s))}).join(", ")]})]}),n&&a&&(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("button",{onClick:()=>i(e.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors duration-200",title:"Delete this log entry (Admin only)",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]})},e.id))})}),(0,r.jsx)("div",{className:"p-6 bg-gray-50 rounded-b-lg flex justify-end",children:(0,r.jsx)("button",{onClick:o,className:"px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Close"})})]})})}function c(){let e=(0,a.useRouter)(),[t,s]=(0,o.useState)([]),[l,c]=(0,o.useState)(!0),[m,u]=(0,o.useState)("Initializing..."),[x,g]=(0,o.useState)(null),[h,f]=(0,o.useState)(null),[y,p]=(0,o.useState)([]),[b,v]=(0,o.useState)([]),[j,w]=(0,o.useState)([]),[N,k]=(0,o.useState)(!1),[_,S]=(0,o.useState)({name:"",category:"",current_stock:0,min_stock:0,storage_location:"",unit:"",expire_date:""}),[C,L]=(0,o.useState)({category:"",status:"",location:""}),[I,A]=(0,o.useState)(""),[E,F]=(0,o.useState)([]),[M,D]=(0,o.useState)(!1),[O,U]=(0,o.useState)(!1),[z,W]=(0,o.useState)(null),[B,P]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=t;I&&(e=e.filter(e=>e.name.toLowerCase().includes(I.toLowerCase()))),C.category&&(e=e.filter(e=>e.category===C.category)),C.status&&(e=e.filter(e=>e.status===C.status)),C.location&&(e=e.filter(e=>e.storage_location===C.location)),F(e)},[t,C,I]);let V=async()=>{try{let{data:e,error:t}=await i.N.from("categories").select("*").order("name");if(!t&&e)return void v(e);let{data:s,error:r}=await i.N.functions.invoke("manage-categories?action=list");!r&&(null==s?void 0:s.data)&&v(s.data)}catch(e){console.error("Failed to fetch categories:",e)}},R=async()=>{try{let{data:e,error:t}=await i.N.from("locations").select("*").order("name");if(!t&&e)return void w(e);let{data:s,error:r}=await i.N.functions.invoke("manage-locations?action=list");!r&&(null==s?void 0:s.data)&&w(s.data)}catch(e){console.error("Failed to fetch locations:",e)}},T=(0,o.useCallback)(async()=>{c(!0),u("Checking authentication...");try{let{data:{user:e}}=await i.N.auth.getUser();if(g(e),!e){f(null),s([]),F([]),c(!1);return}u("Loading user profile...");let{data:t,error:r}=await i.N.from("profiles").select("*").eq("id",e.id).single();if(r)throw Error("Could not fetch user profile.");f(t),u("Loading inventory data...");let[o,a,n,l]=await Promise.all([i.N.from("inventory_items").select("*").order("name",{ascending:!0}),i.N.from("activity_logs").select("*").order("timestamp",{ascending:!1}).limit(50),i.N.from("categories").select("*").order("name"),i.N.from("locations").select("*").order("name")]);if(o.error)throw o.error;s(o.data||[]),F(o.data||[]),a.error||p(a.data||[]),!n.error&&n.data?v(n.data):V(),!l.error&&l.data?w(l.data):R()}catch(t){let e=t instanceof Error?t.message:"An unknown error occurred.";n.Ay.error("Error fetching data: ".concat(e)),console.error("Data fetch error:",t)}finally{c(!1),P(!0)}},[]);(0,o.useEffect)(()=>{B||T()},[B,T]),(0,o.useEffect)(()=>{(async()=>{let e=new URL(window.location.href),t=e.searchParams.get("code"),s=e.searchParams.get("error_description");if(s){n.Ay.error(decodeURIComponent(s)),window.history.replaceState({},document.title,window.location.pathname);return}if(t)try{u("Completing authentication...");let{error:e}=await i.N.auth.exchangeCodeForSession(window.location.href);if(e)return void n.Ay.error("Authentication failed: ".concat(e.message));window.history.replaceState({},document.title,window.location.pathname),n.Ay.success("Login successful!"),P(!1)}catch(e){console.error("Error completing OAuth flow:",e),n.Ay.error("Unable to complete Google login. Please try again.")}})()},[]);let G=async()=>{if(!x||!x.id)return void n.Ay.error("Please login to add items");if(!_.name||!_.category||!_.storage_location)return void n.Ay.error("Please fill in all required fields");let e={name:_.name,category:_.category,current_stock:_.current_stock,min_stock:_.min_stock,storage_location:_.storage_location,unit:_.unit||null,expire_date:_.expire_date||null,status:_.current_stock>_.min_stock?"In Stock":0===_.current_stock?"Out of Stock":"Low Stock",created_by:x.email,updated_by:x.email};console.log("\uD83D\uDD0D Adding item:",e);let{data:r,error:o}=await i.N.from("inventory_items").insert([e]).select().single();if(console.log("\uD83D\uDCCA Insert result:",{data:r,error:o}),o)console.error("Insert error:",o),n.Ay.error("Error: ".concat(o.message));else{console.log("âœ… Success:",r);let o=[...t,r].sort((e,t)=>e.name.localeCompare(t.name));s(o),F(o),n.Ay.success('"'.concat(_.name,'" added!')),S({name:"",category:"",current_stock:0,min_stock:0,storage_location:"",unit:"",expire_date:""}),k(!1),await Z(r.id,r.name,"created",e)}},H=async e=>{try{let{error:t}=await i.N.from("activity_logs").delete().eq("id",e);if(t)throw t;p(y.filter(t=>t.id!==e)),n.Ay.success("Activity log deleted successfully")}catch(t){let e=t instanceof Error?t.message:"Failed to delete activity log";n.Ay.error("Error: ".concat(e)),console.error("Delete activity log error:",t)}},J=async()=>{if(!z||!x||!x.id)return void n.Ay.error("Please login to update items");if(!z.name||!z.category||!z.storage_location)return void n.Ay.error("Please fill in all required fields");let e={name:z.name,category:z.category,current_stock:z.current_stock,min_stock:z.min_stock,storage_location:z.storage_location,unit:z.unit||null,expire_date:z.expire_date||null,status:z.current_stock>z.min_stock?"In Stock":0===z.current_stock?"Out of Stock":"Low Stock",updated_by:x.email,updated_at:new Date().toISOString()},{data:r,error:o}=await i.N.from("inventory_items").update(e).eq("id",z.id).select().single();if(o)n.Ay.error("Error: ".concat(o.message));else{let o=t.map(e=>e.id===z.id?r:e);s(o),F(o),n.Ay.success('"'.concat(z.name,'" updated!')),W(null),U(!1),await Z(z.id,z.name,"updated",e)}},q=async(e,r)=>{if(!confirm('Are you sure you want to delete "'.concat(r,'"?')))return;if(!x||!x.id)return void n.Ay.error("Please login to delete items");let{error:o}=await i.N.from("inventory_items").delete().eq("id",e);o?n.Ay.error("Error deleting item: ".concat(o.message)):(s(t.filter(t=>t.id!==e)),n.Ay.success('"'.concat(r,'" has been deleted.')),await Z(e,r,"deleted",{id:e,name:r}))},Y=async()=>{let e="".concat(window.location.origin).concat("/gmml-inventory","/team-dashboard"),{error:t}=await i.N.auth.signInWithOAuth({provider:"google",options:{redirectTo:e}});t&&n.Ay.error("Login failed: ".concat(t.message))},X=async()=>{await i.N.auth.signOut(),g(null),n.Ay.success("Logged out."),window.location.href="".concat("/gmml-inventory","/")},Z=async(e,t,s,r)=>{if(x&&x.id)try{let o={item_id:e,user_id:x.id,user_email:x.email,action:s,changes:r,item_name:t,timestamp:new Date().toISOString()},{error:a}=await i.N.from("activity_logs").insert([o]);if(!a){let{data:e}=await i.N.from("activity_logs").select("*").order("timestamp",{ascending:!1}).limit(50);e&&p(e)}}catch(e){console.error("Error logging activity:",e)}},Q=E.length,K=E.filter(e=>"In Stock"===e.status).length,$=E.filter(e=>"Low Stock"===e.status).length,ee=E.filter(e=>"Out of Stock"===e.status).length;return l?(0,r.jsx)("div",{className:"flex h-screen items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mb-4"}),(0,r.jsx)("p",{className:"text-lg text-gray-700",children:m}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"This usually takes just a few seconds..."})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.Toaster,{position:"top-right"}),(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,r.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-10 h-10 bg-indigo-600 rounded-lg",children:(0,r.jsx)("span",{className:"text-white font-bold text-lg",children:"G"})}),(0,r.jsx)("div",{children:(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"GMML Inventory System"})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(null==h?void 0:h.role)==="admin"&&(0,r.jsx)("button",{onClick:()=>e.push("/admin"),className:"text-sm font-semibold text-indigo-600 hover:text-indigo-800",children:"Admin Panel"}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:(null==x?void 0:x.email)||"Team Mode"}),x&&x.id?(0,r.jsx)("button",{onClick:X,className:"text-sm font-semibold text-red-600 hover:text-red-800",children:"Logout"}):(0,r.jsx)("button",{onClick:Y,className:"text-sm font-semibold text-indigo-600 hover:text-indigo-800",children:"Login with Google"})]})]})})}),(0,r.jsxs)("main",{className:"mx-auto max-w-7xl py-6 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-4 mb-8",children:[(0,r.jsx)("div",{className:"overflow-hidden rounded-lg bg-white px-6 py-5 shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-900",children:"Total Items"}),(0,r.jsx)("dd",{className:"text-2xl font-semibold text-gray-900",children:Q})]})]})}),(0,r.jsx)("div",{className:"overflow-hidden rounded-lg bg-white px-6 py-5 shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-900",children:"In Stock"}),(0,r.jsx)("dd",{className:"text-2xl font-semibold text-green-600",children:K})]})]})}),(0,r.jsx)("div",{className:"overflow-hidden rounded-lg bg-white px-6 py-5 shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-900",children:"Low Stock"}),(0,r.jsx)("dd",{className:"text-2xl font-semibold text-yellow-600",children:$})]})]})}),(0,r.jsx)("div",{className:"overflow-hidden rounded-lg bg-white px-6 py-5 shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-900",children:"Out of Stock"}),(0,r.jsx)("dd",{className:"text-2xl font-semibold text-red-600",children:ee})]})]})})]}),(0,r.jsxs)("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 mb-6",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-gray-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Filters & Search"})]})}),(0,r.jsx)("div",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search by name"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,r.jsx)("input",{type:"text",id:"search",value:I,onChange:e=>A(e.target.value),placeholder:"Search items...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"filter-category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,r.jsxs)("select",{id:"filter-category",value:C.category,onChange:e=>L({...C,category:e.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"All Categories"}),b.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"filter-location",className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),(0,r.jsxs)("select",{id:"filter-location",value:C.location,onChange:e=>L({...C,location:e.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"All Locations"}),j.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"filter-status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,r.jsxs)("select",{id:"filter-status",value:C.status,onChange:e=>L({...C,status:e.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"All Status"}),(0,r.jsx)("option",{value:"In Stock",children:"In Stock"}),(0,r.jsx)("option",{value:"Low Stock",children:"Low Stock"}),(0,r.jsx)("option",{value:"Out of Stock",children:"Out of Stock"})]})]})]})})]}),(0,r.jsxs)("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Inventory Items"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Showing ",E.length," of ",t.length," items"]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("button",{onClick:()=>D(!0),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Activity Log"]}),(0,r.jsxs)("button",{onClick:()=>{let e=E.map(e=>({"Item Name":e.name,Category:e.category,"Current Stock":e.current_stock,"Min Stock":e.min_stock,Unit:e.unit||"","Expire Date":e.expire_date?new Date(e.expire_date).toLocaleDateString():"",Status:e.status,Location:e.storage_location,Updated:new Date(e.updated_at).toLocaleDateString()}));if(0===e.length)return void n.Ay.error("No data to export.");let t=Object.keys(e[0]),s=new Blob([[t.join(","),...e.map(e=>t.map(t=>'"'.concat(String(e[t]).replace(/"/g,'""'),'"')).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),o=URL.createObjectURL(s);r.setAttribute("href",o),r.setAttribute("download","inventory_export_".concat(new Date().toISOString().split("T")[0],".csv")),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),n.Ay.success("CSV exported successfully!")},className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export CSV"]}),(0,r.jsxs)("button",{onClick:()=>k(!N),disabled:!x||!x.id,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 ".concat(x&&x.id&&(null==h?void 0:h.role)!=="user"?"bg-indigo-600 hover:bg-indigo-700":"bg-gray-400 cursor-not-allowed"),children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),x&&x.id?"Add Item":"Login to Add Items"]})]})]})}),N&&(0,r.jsxs)("div",{className:"mt-6 bg-white shadow rounded-lg p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Item"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"item-name",className:"block text-sm font-medium text-gray-700",children:"Item Name *"}),(0,r.jsx)("input",{type:"text",id:"item-name",value:_.name,onChange:e=>S({..._,name:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",placeholder:"Enter item name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"item-category",className:"block text-sm font-medium text-gray-700",children:"Category *"}),(0,r.jsxs)("select",{id:"item-category",value:_.category,onChange:e=>S({..._,category:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"Select category"}),b.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"storage-location",className:"block text-sm font-medium text-gray-700",children:"Storage Location *"}),(0,r.jsxs)("select",{id:"storage-location",value:_.storage_location,onChange:e=>S({..._,storage_location:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"Select location"}),j.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"current-stock",className:"block text-sm font-medium text-gray-700",children:"Current Stock"}),(0,r.jsx)("input",{type:"number",id:"current-stock",value:_.current_stock,onChange:e=>S({..._,current_stock:parseInt(e.target.value)||0}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",min:"0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"min-stock",className:"block text-sm font-medium text-gray-700",children:"Min Stock"}),(0,r.jsx)("input",{type:"number",id:"min-stock",value:_.min_stock,onChange:e=>S({..._,min_stock:parseInt(e.target.value)||0}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",min:"0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"item-unit",className:"block text-sm font-medium text-gray-700",children:"Unit"}),(0,r.jsx)("input",{type:"text",id:"item-unit",value:_.unit,onChange:e=>S({..._,unit:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",placeholder:"e.g., pcs, kg, L"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"item-expire-date",className:"block text-sm font-medium text-gray-700",children:"Expire Date"}),(0,r.jsx)("input",{type:"date",id:"item-expire-date",value:_.expire_date,onChange:e=>S({..._,expire_date:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900"})]})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{S({name:"",category:"",current_stock:0,min_stock:0,storage_location:"",unit:"",expire_date:""}),k(!1)},className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Cancel"}),(0,r.jsx)("button",{type:"button",onClick:G,className:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Add Item"})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:E.map(e=>(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-4 flex flex-col",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-lg font-semibold text-gray-900 truncate",title:e.name,children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-500 truncate",children:e.category})]}),(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"In Stock":return"bg-green-100 text-green-800";case"Low Stock":return"bg-yellow-100 text-yellow-800";case"Out of Stock":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.status)),children:e.status})})]}),(0,r.jsxs)("div",{className:"mt-4 space-y-2 text-sm text-gray-700 flex-grow",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Stock:"})," ",e.current_stock," / ",e.min_stock," ",e.unit||""]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Location:"})," ",e.storage_location]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-x-4",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Expire Date:"})," ",e.expire_date?new Date(e.expire_date).toLocaleDateString():"-"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Updated:"})," ",new Date(e.updated_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]})]}),(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 flex justify-end space-x-2",children:(null==h?void 0:h.role)!=="user"&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>{W(e),U(!0)},disabled:!x||!x.id,className:"inline-flex items-center p-1.5 rounded-md ".concat(x&&x.id?"text-indigo-600 hover:text-indigo-900 hover:bg-indigo-50":"text-gray-400 cursor-not-allowed"),title:"Edit",children:(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,r.jsx)("button",{onClick:()=>q(e.id,e.name),disabled:!x||!x.id,className:"inline-flex items-center p-1.5 rounded-md ".concat(x&&x.id?"text-red-600 hover:text-red-900 hover:bg-red-50":"text-gray-400 cursor-not-allowed"),title:"Delete",children:(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},e.id))})]}),O&&z&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8 w-full max-w-3xl",children:[(0,r.jsx)("h3",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Edit Item"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"edit-item-name",className:"block text-sm font-medium text-gray-700",children:"Item Name *"}),(0,r.jsx)("input",{type:"text",id:"edit-item-name",value:z.name,onChange:e=>W({...z,name:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",placeholder:"Enter item name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-item-category",className:"block text-sm font-medium text-gray-700",children:"Category *"}),(0,r.jsxs)("select",{id:"edit-item-category",value:z.category,onChange:e=>W({...z,category:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"Select category"}),b.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-storage-location",className:"block text-sm font-medium text-gray-700",children:"Storage Location *"}),(0,r.jsxs)("select",{id:"edit-storage-location",value:z.storage_location,onChange:e=>W({...z,storage_location:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",children:[(0,r.jsx)("option",{value:"",children:"Select location"}),j.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-current-stock",className:"block text-sm font-medium text-gray-700",children:"Current Stock"}),(0,r.jsx)("input",{type:"number",id:"edit-current-stock",value:z.current_stock,onChange:e=>W({...z,current_stock:parseInt(e.target.value)||0}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",min:"0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-min-stock",className:"block text-sm font-medium text-gray-700",children:"Min Stock"}),(0,r.jsx)("input",{type:"number",id:"edit-min-stock",value:z.min_stock,onChange:e=>W({...z,min_stock:parseInt(e.target.value)||0}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",min:"0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-item-unit",className:"block text-sm font-medium text-gray-700",children:"Unit"}),(0,r.jsx)("input",{type:"text",id:"edit-item-unit",value:z.unit||"",onChange:e=>W({...z,unit:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900",placeholder:"e.g., pcs, kg, L"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-item-expire-date",className:"block text-sm font-medium text-gray-700",children:"Expire Date"}),(0,r.jsx)("input",{type:"date",id:"edit-item-expire-date",value:z.expire_date?z.expire_date.split("T")[0]:"",onChange:e=>W({...z,expire_date:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-900"})]})]}),(0,r.jsxs)("div",{className:"mt-8 flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{W(null),U(!1)},className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Cancel"}),(0,r.jsx)("button",{type:"button",onClick:J,className:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Update Item"})]})]})}),M&&(0,r.jsx)(d,{logs:y,userProfile:h,onClose:()=>D(!1),onDeleteLog:H})]})]})]})}}},e=>{e.O(0,[663,796,830,441,255,358],()=>e(e.s=7192)),_N_E=e.O()}]);