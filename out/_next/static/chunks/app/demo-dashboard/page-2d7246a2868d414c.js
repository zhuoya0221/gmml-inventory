(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[101],{170:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>w});var s=o(5155),a=o(2115),r=o(2890),i=o(2663),n=o(5299),l=o(6617),d=o(4485),c=o(9867),m=o(6191),u=o(6651),g=o(6509),h=o(7098),x=o(9315),f=o(5511),p=o(1398),y=o(1251);function v(e){var t;let{user:o}=e;console.log("\uD83D\uDCCA InventoryDashboardDemo component loaded!");let[v,w]=(0,a.useState)(!1),[b,S]=(0,a.useState)([]),[j,_]=(0,a.useState)([]),[N,k]=(0,a.useState)(""),[I,O]=(0,a.useState)(""),[D,A]=(0,a.useState)(""),[C,L]=(0,a.useState)(""),[E,R]=(0,a.useState)(!1),[U,M]=(0,a.useState)(!1),[F,B]=(0,a.useState)(!1),[q,T]=(0,a.useState)(null),[V,G]=(0,a.useState)([]),[P,W]=(0,a.useState)([]),[z,H]=(0,a.useState)([]);(0,a.useEffect)(()=>{o&&(J(),K())},[o]),(0,a.useEffect)(()=>{Q()},[b,N,I,D,C]);let J=async()=>{try{let{data:e,error:t}=await r.N.from("inventory_items").select("*").order("updated_at",{ascending:!1});if(t){console.log("Database fetch failed, showing demo data");let e=[{id:"demo-1",name:"Demo Laptop",photo_url:null,category:"Electronics",current_stock:5,min_stock:2,status:"In Stock",date_updated:new Date().toISOString(),storage_location:"Office A",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),created_by:(null==o?void 0:o.id)||"demo-user",updated_by:(null==o?void 0:o.id)||"demo-user"},{id:"demo-2",name:"Demo Mouse",photo_url:null,category:"Electronics",current_stock:1,min_stock:3,status:"Low Stock",date_updated:new Date().toISOString(),storage_location:"Office B",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),created_by:(null==o?void 0:o.id)||"demo-user",updated_by:(null==o?void 0:o.id)||"demo-user"}];S(e),W(["Electronics"]),H(["Office A","Office B"]);return}S(e||[]);let s=[...new Set((null==e?void 0:e.map(e=>e.category))||[])],a=[...new Set((null==e?void 0:e.map(e=>e.storage_location))||[])];W(s),H(a)}catch(e){console.error("Error fetching items:",e),i.oR.error("Failed to fetch inventory items - showing demo data")}},K=async()=>{try{let{data:e,error:t}=await r.N.from("activity_logs").select("*").order("timestamp",{ascending:!1}).limit(100);if(t)return void console.log("Activity logs fetch failed");G(e||[])}catch(e){console.error("Error fetching activity logs:",e)}},Q=()=>{let e=b;N&&(e=e.filter(e=>e.name.toLowerCase().includes(N.toLowerCase()))),I&&(e=e.filter(e=>e.category===I)),D&&(e=e.filter(e=>e.storage_location===D)),C&&(e=e.filter(e=>e.status===C)),_(e)},X=e=>0===e.current_stock?"Out of Stock":e.current_stock<=e.min_stock?"Low Stock":"In Stock",Y=async e=>{try{let t={...e,status:X(e),created_by:(null==o?void 0:o.id)||"demo-user",updated_by:(null==o?void 0:o.id)||"demo-user"},{data:s,error:a}=await r.N.from("inventory_items").insert([t]).select().single();if(a){let e={...t,id:"demo-"+Date.now(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};S(t=>[e,...t]),i.oR.success("Item added to demo data");return}S(e=>[s,...e]),i.oR.success("Item added successfully"),await r.N.from("activity_logs").insert([{item_id:s.id,item_name:s.name,user_id:(null==o?void 0:o.id)||"demo-user",user_email:(null==o?void 0:o.email)||"demo@gmml.com",action:"created",changes:e,timestamp:new Date().toISOString()}]),K()}catch(e){console.error("Error adding item:",e),i.oR.error("Failed to add item")}},Z=async e=>{try{let t={...e,status:X(e),updated_by:(null==o?void 0:o.id)||"demo-user",updated_at:new Date().toISOString()},{error:s}=await r.N.from("inventory_items").update(t).eq("id",e.id);if(s){S(o=>o.map(o=>o.id===e.id?t:o)),i.oR.success("Item updated in demo data");return}S(o=>o.map(o=>o.id===e.id?t:o)),i.oR.success("Item updated successfully"),await r.N.from("activity_logs").insert([{item_id:e.id,item_name:e.name,user_id:(null==o?void 0:o.id)||"demo-user",user_email:(null==o?void 0:o.email)||"demo@gmml.com",action:"updated",changes:e,timestamp:new Date().toISOString()}]),K()}catch(e){console.error("Error updating item:",e),i.oR.error("Failed to update item")}},$=async e=>{try{let{error:t}=await r.N.from("inventory_items").delete().eq("id",e);if(t){S(t=>t.filter(t=>t.id!==e)),i.oR.success("Item deleted from demo data");return}S(t=>t.filter(t=>t.id!==e)),i.oR.success("Item deleted successfully"),K()}catch(e){console.error("Error deleting item:",e),i.oR.error("Failed to delete item")}};if(v)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)(n.A,{className:"h-8 w-8 animate-spin"})});let ee=b.length,et=b.filter(e=>"In Stock"===e.status).length,eo=b.filter(e=>"Low Stock"===e.status).length,es=b.filter(e=>"Out of Stock"===e.status).length;return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(p.A,{user:o,onSignOut:()=>{window.location.href="/login"}}),(0,s.jsxs)("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("h1",{className:"flex items-center text-3xl font-bold text-gray-900 mb-2",children:[(0,s.jsx)(l.A,{className:"h-8 w-8 mr-3 text-indigo-600"}),"GMML Inventory Dashboard"]}),(0,s.jsx)("p",{className:"text-gray-600",children:(null==o||null==(t=o.email)?void 0:t.includes("demo"))?"Demo mode - authentication in progress":"Manage your team's inventory efficiently"})]}),(0,s.jsx)(y.A,{totalItems:ee,inStockItems:et,lowStockItems:eo,outOfStockItems:es}),(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4 sm:mb-0",children:"Inventory Items"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3",children:[(0,s.jsxs)("button",{onClick:()=>B(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[(0,s.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Activity Log"]}),(0,s.jsxs)("button",{onClick:()=>{let e=new Blob([["Name,Category,Current Stock,Min Stock,Status,Storage Location,Date Updated",...b.map(e=>[e.name,e.category,e.current_stock,e.min_stock,e.status,e.storage_location,new Date(e.date_updated).toLocaleDateString()].join(","))].join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.download="inventory.csv",o.click(),window.URL.revokeObjectURL(t),i.oR.success("Inventory exported to CSV")},className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[(0,s.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Export CSV"]}),(0,s.jsxs)("button",{onClick:()=>R(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700",children:[(0,s.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Add Item"]})]})]}),(0,s.jsxs)("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"search",className:"sr-only",children:"Search"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)(u.A,{className:"h-5 w-5 text-gray-400"})}),(0,s.jsx)("input",{type:"text",placeholder:"Search items...",value:N,onChange:e=>k(e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500"})]})]}),(0,s.jsxs)("select",{value:I,onChange:e=>O(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[(0,s.jsx)("option",{value:"",children:"All Categories"}),P.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),(0,s.jsxs)("select",{value:D,onChange:e=>A(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[(0,s.jsx)("option",{value:"",children:"All Locations"}),z.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),(0,s.jsxs)("select",{value:C,onChange:e=>L(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[(0,s.jsx)("option",{value:"",children:"All Status"}),(0,s.jsx)("option",{value:"In Stock",children:"In Stock"}),(0,s.jsx)("option",{value:"Low Stock",children:"Low Stock"}),(0,s.jsx)("option",{value:"Out of Stock",children:"Out of Stock"})]})]})]}),(0,s.jsx)(g.A,{items:j,onEdit:e=>{T(e),M(!0)},onDelete:$})]})]}),(0,s.jsx)(h.A,{isOpen:E,onClose:()=>R(!1),onAdd:Y,categories:P,locations:z}),(0,s.jsx)(x.A,{isOpen:U,onClose:()=>M(!1),onUpdate:Z,item:q,categories:P,locations:z}),(0,s.jsx)(f.A,{isOpen:F,onClose:()=>B(!1),logs:V})]})}function w(){var e;let[t,o]=(0,a.useState)(null),[i,n]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=()=>{o({id:"demo-user-123",email:"demo@gmml.com",user_metadata:{full_name:"Demo User",avatar_url:null}}),n(!1)};(async()=>{try{let{data:{user:t}}=await r.N.auth.getUser();t?o(t):e()}catch(t){console.log("Auth check failed, using demo mode"),e()}finally{n(!1)}})()},[]);let l=async()=>{try{let{data:e,error:t}=await r.N.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/demo-dashboard")}});t&&alert("Login failed: ".concat(t.message,". Continuing in demo mode."))}catch(e){alert("Login error: ".concat(e.message,". Continuing in demo mode."))}};return i?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})}):(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"bg-yellow-50 border-b border-yellow-200 p-3",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)("span",{className:"text-yellow-800 text-sm",children:(null==t||null==(e=t.email)?void 0:e.includes("demo"))?"\uD83E\uDDEA Demo Mode - "+t.email:"âœ… Logged in as: "+(null==t?void 0:t.email)})}),(0,s.jsx)("button",{onClick:l,className:"text-sm bg-yellow-600 text-white px-3 py-1 rounded hover:bg-yellow-700",children:"Try Real Login"})]})}),(0,s.jsx)(v,{user:t})]})}},7008:(e,t,o)=>{Promise.resolve().then(o.bind(o,170))}},e=>{e.O(0,[945,663,396,629,441,255,358],()=>e(e.s=7008)),_N_E=e.O()}]);